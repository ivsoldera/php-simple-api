# PHP Simple API

A lightweight PHP API boilerplate with basic authentication and user management features.

## Features

- Simple routing system
- JWT authentication
- User management (login, register, password reset)
- OTP verification
- CORS support
- MySQL database integration

## Requirements

- PHP 7.4 or higher
- MySQL/MariaDB
- Nginx
- Composer

## Installation

1. Clone the repository

```
git clone https://github.com/ivsoldera/php-simple-api.git
cd php-simple-api
```

2. Install dependencies

```
composer install
```


3. Configure your database
- Copy `.env.example` to `.env`
- Update the database credentials in `.env` file

4. Create your database

## Project Structure
```
php-simple-api/
├── src/
│ ├── Controllers/
│ ├── Models/
│ ├── Middleware/
│ └── routes/
├── public/
│ └── index.php
└── vendor/
```


## Nginx Configuration

Create a new Nginx server block configuration:
Example Nginx config file 
```
server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name yourdomain.com;

    root /var/www/php-simple-api/public;
    index index.php;

    # SSL certificates generated by Let's Encrypt
    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php/php8.3-fpm.sock; // Here you should check your php fpm version 
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        include fastcgi_params;
        fastcgi_hide_header X-Powered-By;
    }

    location ~ /\. {
        deny all;
    }
}
```


Make sure to:
1. Replace `yourdomain.com` with your actual domain
2. Ensure SSL certificates are properly set up using Let's Encrypt
3. Verify the PHP-FPM socket path matches your system configuration
4. Restart Nginx after making changes: `sudo systemctl restart nginx`

## Available Routes

### Authentication
- `POST /login` - User login
- `POST /refresh-token` - Refresh JWT token
- `POST /forgot-password` - Request password reset
- `PUT /reset-password` - Reset password
- `POST /verify-otp-code` - Verify OTP code

### User Management
- `PUT /update-password` - Update user password (requires authentication)
- `DELETE /delete-account` - Delete user account (requires authentication)

## API Usage

### Making Requests

The API accepts requests with the following base URL:

```
https://yourdomain.com/
```
Example request:
```
curl -X POST https://yourdomain.com/login \
-H "Content-Type: application/json" \
-d '{"email":"user@example.com","password":"yourpassword"}
```


### Authentication

Protected routes require a JWT token in the Authorization header:

```
Authorization: Bearer your-jwt-token
```

## Development

To run the project locally:

1. Configure Nginx using the configuration provided above
2. Ensure PHP-FPM and MySQL are running
3. Set up SSL certificates (Let's Encrypt recommended)
4. Access the API through `https://yourdomain.com/`

## License

This project is licensed under the MIT License - see the LICENSE file for details.
